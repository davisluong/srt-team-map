
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Team Location Map - Collaborative Platform</title>
    
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 1rem 2rem;
            box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: bold;
            color: #4a5568;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .controls {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .btn {
            background: #4299e1;
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn:hover {
            background: #3182ce;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: #718096;
        }

        .btn-secondary:hover {
            background: #4a5568;
        }

        .container {
            display: flex;
            height: calc(100vh - 80px);
            gap: 1rem;
            padding: 1rem;
        }

        .sidebar {
            width: 350px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 12px;
            padding: 1.5rem;
            overflow-y: auto;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .map-container {
            flex: 1;
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        #map {
            height: 100%;
            width: 100%;
        }

        .form-group {
            margin-bottom: 1rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: #2d3748;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 0.9rem;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: #4299e1;
        }

        .form-group textarea {
            resize: vertical;
            min-height: 80px;
        }

        .team-member {
            background: #f7fafc;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1rem;
            transition: all 0.3s ease;
        }

        .team-member:hover {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            transform: translateY(-2px);
        }

        .member-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
        }

        .member-name {
            font-weight: bold;
            color: #2d3748;
            font-size: 1.1rem;
        }

        .member-role {
            color: #4299e1;
            font-size: 0.9rem;
            font-weight: 500;
        }

        .member-actions {
            display: flex;
            gap: 0.5rem;
        }

        .btn-small {
            padding: 0.25rem 0.5rem;
            font-size: 0.8rem;
            border-radius: 4px;
        }

        .btn-edit {
            background: #ed8936;
        }

        .btn-edit:hover {
            background: #dd6b20;
        }

        .btn-delete {
            background: #e53e3e;
        }

        .btn-delete:hover {
            background: #c53030;
        }

        .member-info {
            font-size: 0.9rem;
            color: #4a5568;
            line-height: 1.4;
        }

        .toggle-container {
            background: rgba(255, 255, 255, 0.9);
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1rem;
        }

        .toggle-switch {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            cursor: pointer;
        }

        .switch {
            position: relative;
            width: 50px;
            height: 24px;
            background: #cbd5e0;
            border-radius: 12px;
            transition: background 0.3s ease;
        }

        .switch.active {
            background: #4299e1;
        }

        .switch::before {
            content: '';
            position: absolute;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: white;
            top: 2px;
            left: 2px;
            transition: transform 0.3s ease;
        }

        .switch.active::before {
            transform: translateX(26px);
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            backdrop-filter: blur(5px);
        }

        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 2rem;
            border-radius: 12px;
            width: 90%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .modal-title {
            font-size: 1.25rem;
            font-weight: bold;
            color: #2d3748;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #718096;
        }

        .close-btn:hover {
            color: #2d3748;
        }

        .section-title {
            font-size: 1.1rem;
            font-weight: bold;
            color: #2d3748;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        @media (max-width: 768px) {
            .container {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                height: 300px;
            }
            
            .map-container {
                height: 400px;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="logo">
            <i class="fas fa-globe-americas"></i>
            Team Location Map
        </div>
        <div class="controls">
            <button class="btn" onclick="openAddModal()">
                <i class="fas fa-plus"></i>
                Add Team Member
            </button>
            <button class="btn btn-secondary" onclick="exportData()">
                <i class="fas fa-download"></i>
                Export Data
            </button>
        </div>
    </div>

    <div class="container">
        <div class="sidebar">
            <div class="toggle-container">
                <div class="toggle-switch" onclick="toggleConnections()">
                    <div class="switch" id="connectionToggle"></div>
                    <span>Show Connection Lines</span>
                </div>
            </div>

            <div class="section-title">
                <i class="fas fa-users"></i>
                Team Members
            </div>
            
            <div id="teamList">
                <!-- Team members will be populated here -->
            </div>
        </div>

        <div class="map-container">
            <div id="map"></div>
        </div>
    </div>

    <!-- Add/Edit Modal -->
    <div id="memberModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title" id="modalTitle">Add Team Member</div>
                <button class="close-btn" onclick="closeModal()">&times;</button>
            </div>
            
            <form id="memberForm">
                <div class="form-group">
                    <label for="memberName">Name *</label>
                    <input type="text" id="memberName" required>
                </div>
                
                <div class="form-group">
                    <label for="memberRole">Role *</label>
                    <input type="text" id="memberRole" required>
                </div>
                
                <div class="form-group">
                    <label for="currentLocation">Current Location *</label>
                    <input type="text" id="currentLocation" placeholder="e.g., New York, USA" required>
                </div>
                
                <div class="form-group">
                    <label for="birthPlace">Birth Place *</label>
                    <input type="text" id="birthPlace" placeholder="e.g., London, UK" required>
                </div>
                
                <div class="form-group">
                    <label for="memberNotes">Notes</label>
                    <textarea id="memberNotes" placeholder="Additional information about the team member..."></textarea>
                </div>
                
                <div style="display: flex; gap: 1rem; justify-content: flex-end; margin-top: 1.5rem;">
                    <button type="button" class="btn btn-secondary" onclick="closeModal()">Cancel</button>
                    <button type="submit" class="btn">
                        <i class="fas fa-save"></i>
                        Save Member
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    
    <script>
        // Global variables
        let map;
        let teamMembers = [];
        let currentEditId = null;
        let showConnections = false;
        let markers = [];
        let connectionLines = [];

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            initializeMap();
            loadSampleData();
            renderTeamList();
            updateMap();
        });

        // Initialize the map
        function initializeMap() {
            map = L.map('map').setView([20, 0], 2);
            
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '© OpenStreetMap contributors'
            }).addTo(map);
        }

        // Load sample data
        function loadSampleData() {
            teamMembers = [
                {
                    id: 1,
                    name: "Sarah Johnson",
                    role: "Frontend Developer",
                    currentLocation: "Toronto, Canada",
                    birthPlace: "Vancouver, Canada",
                    notes: "Specializes in React and Vue.js. Loves hiking and photography.",
                    currentCoords: [43.6532, -79.3832],
                    birthCoords: [49.2827, -123.1207]
                },
                {
                    id: 2,
                    name: "Miguel Rodriguez",
                    role: "Backend Engineer",
                    currentLocation: "Mexico City, Mexico",
                    birthPlace: "Guadalajara, Mexico",
                    notes: "Expert in Node.js and Python. Passionate about AI and machine learning.",
                    currentCoords: [19.4326, -99.1332],
                    birthCoords: [20.6597, -103.3496]
                },
                {
                    id: 3,
                    name: "Priya Patel",
                    role: "UX Designer",
                    currentLocation: "London, UK",
                    birthPlace: "Mumbai, India",
                    notes: "Creative designer with 5+ years experience. Loves user research and prototyping.",
                    currentCoords: [51.5074, -0.1278],
                    birthCoords: [19.0760, 72.8777]
                }
            ];
        }

        // Geocoding function (simplified - in production use a proper geocoding service)
        async function geocodeLocation(location) {
            // This is a simplified geocoding function
            // In a real application, you'd use a proper geocoding service like Google Maps API
            const geocodeData = {
                "Toronto, Canada": [43.6532, -79.3832],
                "Vancouver, Canada": [49.2827, -123.1207],
                "Mexico City, Mexico": [19.4326, -99.1332],
                "Guadalajara, Mexico": [20.6597, -103.3496],
                "London, UK": [51.5074, -0.1278],
                "Mumbai, India": [19.0760, 72.8777],
                "New York, USA": [40.7128, -74.0060],
                "Los Angeles, USA": [34.0522, -118.2437],
                "Paris, France": [48.8566, 2.3522],
                "Berlin, Germany": [52.5200, 13.4050],
                "Tokyo, Japan": [35.6762, 139.6503],
                "Sydney, Australia": [-33.8688, 151.2093]
            };
            
            return geocodeData[location] || [0, 0];
        }

        // Render team list
        function renderTeamList() {
            const teamList = document.getElementById('teamList');
            teamList.innerHTML = '';

            if (teamMembers.length === 0) {
                teamList.innerHTML = '<p style="text-align: center; color: #718096; font-style: italic;">No team members added yet.</p>';
                return;
            }

            teamMembers.forEach(member => {
                const memberDiv = document.createElement('div');
                memberDiv.className = 'team-member';
                memberDiv.innerHTML = `
                    <div class="member-header">
                        <div>
                            <div class="member-name">${member.name}</div>
                            <div class="member-role">${member.role}</div>
                        </div>
                        <div class="member-actions">
                            <button class="btn btn-small btn-edit" onclick="editMember(${member.id})">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn btn-small btn-delete" onclick="deleteMember(${member.id})">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                    <div class="member-info">
                        <div><strong>Current:</strong> ${member.currentLocation}</div>
                        <div><strong>Born:</strong> ${member.birthPlace}</div>
                        ${member.notes ? `<div><strong>Notes:</strong> ${member.notes}</div>` : ''}
                    </div>
                `;
                teamList.appendChild(memberDiv);
            });
        }

        // Update map with markers and connections
        function updateMap() {
            // Clear existing markers and lines
            markers.forEach(marker => map.removeLayer(marker));
            connectionLines.forEach(line => map.removeLayer(line));
            markers = [];
            connectionLines = [];

            // Add markers for each team member
            teamMembers.forEach(member => {
                if (member.currentCoords && member.birthCoords) {
                    // Current location marker (blue)
                    const currentMarker = L.marker(member.currentCoords)
                        .addTo(map)
                        .bindPopup(`
                            <div style="text-align: center;">
                                <strong>${member.name}</strong><br>
                                <em>${member.role}</em><br>
                                <small>Current Location</small>
                            </div>
                        `);
                    markers.push(currentMarker);

                    // Birth place marker (green)
                    const birthMarker = L.marker(member.birthCoords, {
                        icon: L.icon({
                            iconUrl: 'data:image/svg+xml;base64,' + btoa(`
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="green" width="25" height="41">
                                    <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>
                                </svg>
                            `),
                            iconSize: [25, 41],
                            iconAnchor: [12, 41],
                            popupAnchor: [1, -34]
                        })
                    })
                        .addTo(map)
                        .bindPopup(`
                            <div style="text-align: center;">
                                <strong>${member.name}</strong><br>
                                <em>${member.role}</em><br>
                                <small>Birth Place</small>
                            </div>
                        `);
                    markers.push(birthMarker);

                    // Connection line (if enabled)
                    if (showConnections) {
                        const connectionLine = L.polyline([member.currentCoords, member.birthCoords], {
                            color: '#4299e1',
                            weight: 2,
                            opacity: 0.7,
                            dashArray: '10, 10'
                        }).addTo(map);
                        connectionLines.push(connectionLine);
                    }
                }
            });
        }

        // Toggle connection lines
        function toggleConnections() {
            showConnections = !showConnections;
            const toggle = document.getElementById('connectionToggle');
            
            if (showConnections) {
                toggle.classList.add('active');
            } else {
                toggle.classList.remove('active');
            }
            
            updateMap();
        }

        // Open add modal
        function openAddModal() {
            currentEditId = null;
            document.getElementById('modalTitle').textContent = 'Add Team Member';
            document.getElementById('memberForm').reset();
            document.getElementById('memberModal').style.display = 'block';
        }

        // Edit member
        function editMember(id) {
            const member = teamMembers.find(m => m.id === id);
            if (!member) return;

            currentEditId = id;
            document.getElementById('modalTitle').textContent = 'Edit Team Member';
            document.getElementById('memberName').value = member.name;
            document.getElementById('memberRole').value = member.role;
            document.getElementById('currentLocation').value = member.currentLocation;
            document.getElementById('birthPlace').value = member.birthPlace;
            document.getElementById('memberNotes').value = member.notes || '';
            document.getElementById('memberModal').style.display = 'block';
        }

        // Delete member
        function deleteMember(id) {
            if (confirm('Are you sure you want to delete this team member?')) {
                teamMembers = teamMembers.filter(m => m.id !== id);
                renderTeamList();
                updateMap();
            }
        }

        // Close modal
        function closeModal() {
            document.getElementById('memberModal').style.display = 'none';
            currentEditId = null;
        }

        // Handle form submission
        document.getElementById('memberForm').addEventListener('submit', async function(e) {
            e.preventDefault();

            const name = document.getElementById('memberName').value;
            const role = document.getElementById('memberRole').value;
            const currentLocation = document.getElementById('currentLocation').value;
            const birthPlace = document.getElementById('birthPlace').value;
            const notes = document.getElementById('memberNotes').value;

            // Geocode locations
            const currentCoords = await geocodeLocation(currentLocation);
            const birthCoords = await geocodeLocation(birthPlace);

            const memberData = {
                name,
                role,
                currentLocation,
                birthPlace,
                notes,
                currentCoords,
                birthCoords
            };

            if (currentEditId) {
                // Edit existing member
                const index = teamMembers.findIndex(m => m.id === currentEditId);
                if (index !== -1) {
                    teamMembers[index] = { ...memberData, id: currentEditId };
                }
            } else {
                // Add new member
                const newId = Math.max(...teamMembers.map(m => m.id), 0) + 1;
                teamMembers.push({ ...memberData, id: newId });
            }

            renderTeamList();
            updateMap();
            closeModal();
        });

        // Export data
        function exportData() {
            const dataStr = JSON.stringify(teamMembers, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'team-members.json';
            link.click();
            URL.revokeObjectURL(url);
        }

        // Close modal when clicking outside
        window.addEventListener('click', function(e) {
            const modal = document.getElementById('memberModal');
            if (e.target === modal) {
                closeModal();
            }
        });
    </script>
</body>
</html>
